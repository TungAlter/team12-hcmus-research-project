# Research Project 11: Proxy
## I. What Is Proxy ?
Assumed that you have a computer system in your organization that being used by two type of users. One of them is employees (aka Users) which have limited access to some of the functions on the system. The others one is Managers (aka Admins) which have all access to Users functions as well of some of the function that only them allowed to run.

The easy solution for this problem in OOP would be using Inheritance:<br><br>
![](https://raw.githubusercontent.com/trunghieumickey/team12-hcmus-research-project/main/11/naive.png)
```c++
class User{
	protected:
		string someData;
	public:
		void UserFunction(){
			cout << "UserFunction";
		}
};

class Admin : public User{
	public:
		void AdminFuction(){
			cout << "AdminFuction";
		}
};
```

But this does come up with a few problems. One of them is that a User pointer couldn't be contain an admin very well in case your app also have to support an Admin to run their functions
```c++
User *Joe = new Admin;
Joe->AdminFunction();
```
```
Error: no member named 'AdminFunction' in 'User'
```
Even if you somehow work around that (like using interpreter programing language). It would still halt when Users try to run Admin only functions and it could breakdown the whole system. It would be way better if the program is responded to the Users that they can't run Admin function but still effective at protecting the system from being exploits from Users.
### Introducing Proxy
Proxy means ‘in place of’, representing’ or ‘in place of’ or ‘on behalf of’ are literal meanings of proxy and that directly explains Proxy Design Pattern.
Proxies are also called surrogates, handles, and wrappers. They are closely related in structure, but not purpose, to Adapters and Decorators.

A real world example can be a cheque or credit card is a proxy for what is in our bank account. It can be used in place of cash, and provides a means of accessing that cash when required. And that’s exactly what the Proxy pattern does – “Controls and manage access to the object they are protecting“.

![](https://raw.githubusercontent.com/trunghieumickey/team12-hcmus-research-project/main/11/ProxyDiagram.png)

Now, let return to our problem at the begining, since proxy can be used to manage access to objects. Using **Protection Proxy** might help us solve this problem.<br>
![](https://raw.githubusercontent.com/trunghieumickey/team12-hcmus-research-project/main/11/Protection.png)

```c++
struct UserService{
	virtual void UserFunction() = 0;
	virtual void AdminFunction() = 0;
};

struct Admin : public UserService{
	void UserFunction(){
		cout << "UserFunction";
	}
	void AdminFunction(){
		cout << "AdminFunction";
	}
};

class User : public UserService{
	private:
		string role;
		Admin *elevated;
	public:

		User(string role){
			this->role = role;
			if(role == "Admin"){
				elevated = new Admin();
			}
		}

		void UserFunction(){
			cout << "UserFunction";
		}

		void AdminFunction(){
			if (role == "Admin"){
				elevated->AdminFunction();
			}
			else{
				cerr << "You are not Admin";
			}
		}
};
```
Now let test it out to see if it works as intended.
```c++
int main(){
	User *Joe = new User("Admin");
	User *Jane = new User("User");
	Joe->UserFunction();
	Joe->AdminFunction();
	Jane->UserFunction();
	Jane->AdminFunction();
	return 0;
}
```
```
UserFunction
AdminFunction
UserFunction
You are not Admin
```
It works perfectly. As you can see, Joe can run Admin function but Jane can't. Because the elevated object is only created when the user is Admin.
## II. Advantages and Drawbacks of Proxy Design
Sometime Proxy design is very similar to the Adapter and Decorator design pattern. Through it may used to solve the same problem but we should be choose carefully which one is appropriate. Here is the list of the advantages and disadvantages of Proxy design:
### Advantages 
- Practical data consumption by the application clients 
- Ease of implementation 
- Possibility of good programming techniques at proxy level, such as caching 
- Encapsulation of access to microservices 
- Control and diversion of requests 
- Open/Closed Principle. You can introduce new proxies without changing the service or clients 
- The proxy works even if the service object isn’t ready or is not available. 

###  Drawbacks
- Inappropriate change of response 
- Obstruction in the identification of overload 
- The code may become more complicated since you need to introduce a lot of new classes. 
- The response from the service might get delayed 
## III. Types of Proxy
There are many types of proxy to solve the variety of different problems. Through it still share the same structure but serve different purpose. We will cover a few of them in this section.
### Protection Proxy
The above problem is one of the most basic example of the Proxy design pattern. The protection proxy is a proxy that controls access to the object it is protecting. It is used to protect the object from unauthorized access. In above example, it protect the Admin object from unauthorized access from normal users.
### Virtual Proxy
Sometimes we have some objects which consume very much time and memory to initialize but we don't use them after we have initialized them, that's really wasteful. And that's very dangerous for programs that are required to optimize the memory they need to operate. To solve the problem mentioned above we will use Virtual Proxy.<br><br>
The Virtual Proxy acts as a presentation for an object that maybe expensive to creat. That Virtual Proxy often defers the creation of the object until it is needed; the Virtual Proxy also acts as a surrogate for the object before and while it is being created. After that, the proxy delegate request directly to the real subject.<br>
![](https://raw.githubusercontent.com/trunghieumickey/team12-hcmus-research-project/main/11/Virtual.png)<br>
For example, initializing an object of class video by following a path to this video and loading it to the program takes a lot of time and resources. But it is not always we will interact with it as soon as it is created. That will lead to waste of memory and time. So we can use the Virtual Proxy to delay the creation of the object until it is needed. We will use a proxy to represent the real video to interact with the client and control real video’s initialization.<br>
![](https://raw.githubusercontent.com/trunghieumickey/team12-hcmus-research-project/main/11/VirtualDiagram.png)<br>



## IV. Reference Sources
- https://www.geeksforgeeks.org/proxy-design-pattern
- https://toihocdesignpattern.com/chuong-11-proxy-pattern-kiem-soat-truy-cap-doi-tuong-p1.html
- https://www.youtube.com/watch?v=6-wr0E-7Es0
- https://www.youtube.com/watch?v=f3lqH05nW9E
- https://refactoring.guru/design-patterns/proxy
- https://www.coursehero.com/file/78406644/pros-and-consdocx
## VI. About Our Team

### Group Members

- Lê Trần Trung Hiếu [20127158] [@trunghieumickey](https://github.com/trunghieumickey)
- Nguyễn Hoàng Gia Huy [20127186] [@giahuyday](https://github.com/giahuyday)
- Thái Văn Thiên [20127631] [@thienhk15](https://github.com/thienhk15)
- Lê Phan Duy Tùng [20127661] [@TungAlter](https://github.com/TungAlter)

*github accounts included to tracking commits on github

### Class Info
- Class ID: **20CLC01**
- Subject: 	Object Oriented Programming
- Instructors: Đinh Bá Tiến
- Project subject: Proxy
- Project ID : 11
